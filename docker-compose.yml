version: "3"

services:
  redis:
    image: redis:alpine3.9
    container_name: "rates_redis"
    sysctls:
      net.core.somaxconn: '511'
    volumes:
      - redis_data:/data
  front:
    image: abiosoft/caddy
    container_name: "rates_front"
    ports:
      - 80:80
    volumes:
      - ./docker/caddy/Caddyfile:/etc/Caddyfile
      - .:/app
    depends_on:
      - app
  app:
    image: flameplace_app:alpine
    build: ./docker/
    container_name: "rates_app"
    volumes:
      - .:/app
    depends_on:
      - redis
volumes:
  redis_data:
